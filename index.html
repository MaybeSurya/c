<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MaybeSurya.dev | Codebase</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- Prism -->
<link id="prism-theme" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>

<style>
:root{
  --bg:#f5f5f7;
  --text:#1d1d1f;
  --muted:#6e6e73;
  --glass:rgba(255,255,255,0.6);
  --border:rgba(255,255,255,0.4);
}

body.dark{
  --bg:#0f0f11;
  --text:#f5f5f7;
  --muted:#a1a1a6;
  --glass:rgba(30,30,32,0.6);
  --border:rgba(255,255,255,0.08);
}

*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",
  "SF Pro Text","Helvetica Neue",Helvetica,Arial,sans-serif;
}

body{
  background:var(--bg);
  color:var(--text);
  transition:background .4s,color .4s;
  overflow-x:hidden;
}

/* Hero */

.hero{
  padding:120px 20px 80px;
  text-align:center;
  position:relative;
}

.hero h1{
  font-size:42px;
  font-weight:600;
  letter-spacing:-1px;
}

.hero p{
  margin-top:16px;
  font-size:18px;
  color:var(--muted);
}

.parallax-bg{
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 30% 30%,rgba(0,0,0,0.05),transparent 50%);
  transform:translateY(0);
  transition:transform .2s ease-out;
  pointer-events:none;
}

/* Container */

.container{
  max-width:1100px;
  margin:0 auto 100px;
  padding:0 24px;
}

.projects{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
  gap:32px;
}

/* Glass Cards */

.card{
  backdrop-filter:blur(20px);
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:28px;
  padding:28px;
  transition:transform .3s ease;
}

.card:hover{
  transform:translateY(-10px);
}

.card h3{
  font-size:18px;
  margin-bottom:10px;
}

.meta{
  font-size:12px;
  color:var(--muted);
  margin-bottom:12px;
}

.tags{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:12px;
}

.tag{
  font-size:11px;
  padding:4px 10px;
  border-radius:999px;
  background:rgba(255,255,255,0.25);
}

body.dark .tag{
  background:rgba(255,255,255,0.08);
}

.readme{
  font-size:13px;
  color:var(--muted);
  margin-bottom:16px;
  line-height:1.5;
}

.actions{
  display:flex;
  gap:12px;
}

.btn{
  flex:1;
  padding:10px;
  border-radius:14px;
  border:1px solid var(--border);
  background:transparent;
  cursor:pointer;
  font-size:13px;
}

.btn:hover{
  background:rgba(255,255,255,0.2);
}

/* Modal */

.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  backdrop-filter:blur(10px);
  justify-content:center;
  align-items:center;
  padding:20px;
  z-index:1000;
}

.modal-box{
  width:100%;
  max-width:950px;
  background:var(--bg);
  border-radius:28px;
  overflow:hidden;
}

.modal-header{
  display:flex;
  justify-content:space-between;
  padding:18px 22px;
  border-bottom:1px solid var(--border);
}

pre{
  margin:0;
  padding:24px;
  max-height:70vh;
  overflow:auto;
  font-size:13px;
}

/* Ripple */

.ripple{
  position:fixed;
  border-radius:50%;
  transform:scale(0);
  animation:ripple .6s linear;
  background:rgba(255,255,255,.4);
  pointer-events:none;
  z-index:2000;
}

@keyframes ripple{
  to{
    transform:scale(20);
    opacity:0;
  }
}
</style>
</head>
<body>

<section class="hero">
  <div class="parallax-bg" id="parallax"></div>
  <h1>Codebase</h1>
  <p>Minimal. Structured. Intentional.</p>
</section>

<div class="container">
  <div class="projects" id="projects"></div>
</div>

<div class="modal" id="modal">
  <div class="modal-box">
    <div class="modal-header">
      <strong id="modalTitle"></strong>
      <div>
        <i class="fa-regular fa-copy" onclick="copyCode()"></i>
        <i class="fa-solid fa-xmark" onclick="closeModal()"></i>
      </div>
    </div>
    <pre><code id="codeBlock"></code></pre>
  </div>
</div>

<script>
const repo="MaybeSurya/c";
let files=[];

/* Parallax */
window.addEventListener("scroll",()=>{
  document.getElementById("parallax")
    .style.transform=`translateY(${window.scrollY*0.2}px)`;
});

/* Theme Ripple */
function toggleTheme(e){
  const ripple=document.createElement("span");
  ripple.classList.add("ripple");
  ripple.style.left=e.clientX+"px";
  ripple.style.top=e.clientY+"px";
  document.body.appendChild(ripple);
  setTimeout(()=>ripple.remove(),600);

  document.body.classList.toggle("dark");
  localStorage.setItem("theme",
    document.body.classList.contains("dark")?"dark":"light");

  document.getElementById("prism-theme").href =
    document.body.classList.contains("dark")
    ? "https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
    : "https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css";
}

document.body.addEventListener("dblclick",toggleTheme);

(function initTheme(){
  const saved=localStorage.getItem("theme");
  if(saved==="dark") document.body.classList.add("dark");
})();

/* Fetch */

async function fetchProjects(){
  const res=await fetch(`https://api.github.com/repos/${repo}/contents`);
  files=await res.json();
  render();
}

/* Detect tags from comments */
function extractTags(code){
  const firstLines=code.split("\n").slice(0,10).join(" ");
  const keywords=["algorithm","sorting","file","data","tree","graph","math","game"];
  return keywords.filter(k=>firstLines.toLowerCase().includes(k));
}

/* Per-file README detection */
async function getReadmeForFile(file){
  const base=file.name.replace(/\.(c|cpp)$/,"");
  try{
    const res=await fetch(`https://api.github.com/repos/${repo}/contents/${base}.md`);
    if(res.ok){
      const data=await res.json();
      return atob(data.content).slice(0,180)+"...";
    }
  }catch{}
  return "";
}

async function render(){
  const container=document.getElementById("projects");
  container.innerHTML="";

  for(const f of files.filter(f=>f.name.endsWith(".c")||f.name.endsWith(".cpp"))){

    const codeRes=await fetch(f.download_url);
    const code=await codeRes.text();
    const tags=extractTags(code);
    const readme=await getReadmeForFile(f);

    const size=(f.size/1024).toFixed(1)+" KB";

    container.innerHTML+=`
      <div class="card">
        <h3>${f.name}</h3>
        <div class="meta">${size}</div>
        <div class="tags">
          ${tags.map(t=>`<span class="tag">${t}</span>`).join("")}
        </div>
        <div class="readme">${readme}</div>
        <div class="actions">
          <button class="btn" onclick="preview('${f.download_url}','${f.name}')">
            <i class="fa-regular fa-eye"></i> Preview
          </button>
          <a class="btn" href="${f.download_url}" download>
            <i class="fa-solid fa-download"></i> Download
          </a>
        </div>
      </div>`;
  }
}

/* Preview */

async function preview(url,name){
  const res=await fetch(url);
  const txt=await res.text();
  document.getElementById("modalTitle").textContent=name;
  const block=document.getElementById("codeBlock");
  block.textContent=txt;
  block.className=name.endsWith(".c")?"language-c":"language-cpp";
  Prism.highlightElement(block);
  document.getElementById("modal").style.display="flex";
}

function closeModal(){
  document.getElementById("modal").style.display="none";
}

function copyCode(){
  navigator.clipboard.writeText(document.getElementById("codeBlock").textContent);
}

fetchProjects();
</script>
</body>
</html>
